```{r, include=FALSE}
library(DT)
library(tidyverse)
knitr::opts_chunk$set(echo=FALSE, message=FALSE)
```


### {.tabset .tabset-fade .tabset-pills}
#### Partial data
```{r}
# change titles to links
read_tsv("https://raw.githubusercontent.com/agricolamz/The_Circassian_Isoglosses_Database/master/database.csv") %>% 
  mutate(title = paste0("<a href = 'https://agricolamz.github.io/The_Circassian_Isoglosses_Database/",
                        feature_id,
                        ".html'>",
                        title,
                        "</a>")) ->
  db

db %>% 
  mutate(value = paste(value, "<br>", source)) %>% 
  group_by(feature_id, idiom) %>% 
  mutate(value = str_c(value, collapse = "<br>")) %>% 
  select(title, contributor, idiom, value) %>% 
  distinct() %>% 
  spread(idiom, value) %>% 
  mutate_all(function(x){ifelse(is.na(x), "", x)}) %>% 
  datatable(escape = FALSE)
```

#### Whole dataset
```{r}
DT::datatable(db[,-6],escape = FALSE) # remove description column
```


```{r, include=FALSE}
# isoglosses creation

sapply(seq_along(db$feature_id), function(i){
  indexes <- which(db$feature_id %in% db$feature_id[i])
  title <- paste0("## ", db$feature_id[i], ". ", db$title[i])
  description <- c("### Description", "", 
                   db$description[i], "",
                   db$comment[!is.na(db$comment[i])], "")
  values <- c("### Values",
              "There are the following value for each idiom:",
              "",
              paste("*", db$idiom[indexes], db$value[indexes], db$source[indexes]), 
              "")
  text <- c(title, description, values)
  writeLines(text, paste0(db$feature_id[i], ".Rmd"))
  }
)

```

